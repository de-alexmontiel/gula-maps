<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gula Maps</title>

  <!-- External Libraries -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400" rel="stylesheet" />
  <link rel="stylesheet" href="{{ url_for('static', filename='css/tooplate-wave-cafe.css') }}">
</head>

<body>
  <div class="tm-container">
    <div class="tm-row">
      <!-- Main Content -->
      <div class="tm-right">
        <main class="tm-main">
          
          <!-- Toggle Button for Mobile Menu -->
          <div class="tm-menu-toggle" id="menu-toggle">&#9776;</div>

          <!-- Navigation Bar -->
          <div class="tm-icon-bar" id="menu">
            <a href="#food" class="tm-page-link active">
              <i class="fas fa-home tm-page-link-icon"></i>
              Inicio
            </a>
            <a href="#about" class="tm-page-link">
              <i class="fas fa-info-circle tm-page-link-icon"></i>
              Servicios
            </a>
            <a href="#special" class="tm-page-link">
              <i class="fas fa-exclamation-circle tm-page-link-icon"></i>
              En construcción
            </a>
            <a href="#contact" class="tm-page-link">
              <i class="fas fa-phone tm-page-link-icon"></i>
              Contact
            </a>
          </div>

          <!-- Places Section -->
          <div id="food" class="tm-page-content">
            <nav class="tm-black-bg tm-drinks-nav">
              <ul>
                <li><a href="#" class="tm-tab-link active" data-id="resta">Restaurantes</a></li>
                <li><a href="#" class="tm-tab-link" data-id="bar">Bares</a></li>
                <li><a href="#" class="tm-tab-link" data-id="cafe">Cafeterías</a></li>
              </ul>
            </nav>

            <!-- Search Bar -->
            <div class="search-bar">
              <input type="text" id="search-input" placeholder="Buscar por nombre...">
            </div>

            <!-- Common Section Template -->
            {% for category, data in [('resta', restaurants), ('bar', bars), ('cafe', cafes)] %}
            <div id="{{ category }}" class="tm-tab-content">
              <div class="tm-list-container">
                {% for place in data %}
                <div class="tm-list-item">
                  <!-- Verificar si hay un icono personalizado -->
                  {% if place['Icono'] is defined %}
                  <img src="static/img/{{ place['Icono'] }}" alt="Image" class="tm-list-item-logo">
                  {% else %}
                  <img src="static/img/{{ category }}-logo.png" alt="Image" class="tm-list-item-logo">
                  {% endif %}

                  <!-- Contenedor del texto y la información del lugar -->
                  <div class="tm-list-item-text">
                    <h3 class="tm-list-item-name">{{ place['Nombre'] }}</h3>
                    <p class="tm-list-item-description">Rating: {{ place['Rating'] }}</p>

                    <!-- Enlace a WhatsApp -->
                    <span class="tm-list-item-price">
                      <a href="https://wa.me/{{ place['Teléfono']|string|replace(' ', '') }}" target="_blank">Ordenar vía Whatsapp</a>
                    </span>

                    <!-- Enlace a Google Maps -->
                    <a href="{{ place['URL del Lugar'] }}" target="_blank">
                      <p class="tm-list-item-description">Ver en Google Maps</p>
                    </a>
                  </div>
                </div>
                {% endfor %}
              </div>
            </div>
            {% endfor %}
          </div>

          <!-- About Us Page -->
          <div id="about" class="tm-page-content">
            <!-- About content -->
          </div>

          <!-- Special Items Page -->
          <div id="special" class="tm-page-content">
            <!-- Special items content -->
          </div>

          <!-- Contact Page -->
          <div id="contact" class="tm-page-content">
            <!-- Contact form content -->
          </div>

        </main>
      </div>
    </div>

    <!-- Footer -->
    <footer class="tm-site-footer">
      <p class="tm-black-bg tm-footer-text">
        Pto el que lo lea | Dev IG: <a href="https://www.tooplate.com" class="tm-footer-link" rel="sponsored"
          target="_parent">@talegaman</a>
      </p>
    </footer>
  </div>

  <!-- Scripts -->
  <script src="{{ url_for('static', filename='js/jquery-3.4.1.min.js') }}"></script>
  <script>
    // Document Ready
    $(document).ready(function () {
      // Initial page setup
      initPage();

      // Toggle menu for mobile
      $('#menu-toggle').on('click', function () {
        $('#menu').toggleClass('active');
      });

      // Handle page navigation links
      $('.tm-page-link').on('click', function (event) {
        event.preventDefault();
        highlightMenu($(this)); // Highlight the selected menu item
        const targetPage = $(this.hash);
        showPage(targetPage); // Show the selected page
      });

      // Handle tab navigation within the food section
      $('.tm-tab-link').on('click', function (event) {
        event.preventDefault();
        openTab(event, $(this).data('id'));
      });

      // Search filtering logic
      $('#search-input').on('input', function () {
        const searchText = $(this).val().toLowerCase();
        $('.tm-list-item').each(function () {
          const placeName = $(this).find('.tm-list-item-name').text().toLowerCase();
          $(this).toggle(placeName.includes(searchText));
        });
      });
    });

    function initPage() {
      // Hide all tab content
      $('.tm-tab-content').hide();
      // Show restaurants tab by default
      $('#resta').show();
      // Activate the first tab
      $('.tm-tab-link[data-id="resta"]').addClass('active');
      // Hide all other pages
      $('.tm-page-content').hide();
      // Show the food page
      $('#food').show();
    }

    function openTab(evt, id) {
      $('.tm-tab-content').hide();
      $('#' + id).show();
      $('.tm-tab-link').removeClass('active');
      $(evt.currentTarget).addClass('active');
    }

    function highlightMenu(menuItem) {
      $('.tm-page-link').removeClass('active');
      menuItem.addClass('active');
    }

    function showPage(page) {
      $('.tm-page-content').hide();
      page.show();
    }
  </script>
</body>

</html>
